#include "esp_timer.h"
#include "fft.h" // Include the header for the module being tested
#include "fixed_point.h"
#include "unity.h" // Include the Unity test framework header
#include <stdint.h>

TEST_CASE("reverse_bits_2", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 2

  struct FFT_Params params = {.fft_size_bits = FFT_SIZE_BITS};

  uint32_t input[1 << FFT_SIZE_BITS] = {0, 1, 2, 3};
  uint32_t correct[1 << FFT_SIZE_BITS] = {0, 2, 1, 3};

  int64_t start_time = esp_timer_get_time();
  for (size_t i = 0; i < 1 << FFT_SIZE_BITS; i++) {
    input[i] = reverse_bits(&params, input[i]);
  }
  int64_t end_time = esp_timer_get_time();
  printf("%lld\n", end_time - start_time);

  for (size_t i = 0; i < 1 << FFT_SIZE_BITS; i++) {
    TEST_ASSERT_EQUAL_INT(correct[i], input[i]);
  }
#undef FFT_SIZE
}

TEST_CASE("reverse_bits_3", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 3

  struct FFT_Params params = {.fft_size_bits = FFT_SIZE_BITS};

  uint32_t input[1 << FFT_SIZE_BITS] = {0, 1, 2, 3, 4, 5, 6, 7};
  uint32_t correct[1 << FFT_SIZE_BITS] = {0, 4, 2, 6, 1, 5, 3, 7};

  int64_t start_time = esp_timer_get_time();
  for (size_t i = 0; i < 1 << FFT_SIZE_BITS; i++) {
    input[i] = reverse_bits(&params, input[i]);
  }
  int64_t end_time = esp_timer_get_time();
  printf("%lld\n", end_time - start_time);

  for (size_t i = 0; i < 1 << FFT_SIZE_BITS; i++) {
    TEST_ASSERT_EQUAL_INT(correct[i], input[i]);
  }
#undef FFT_SIZE
}

TEST_CASE("reverse_bits_4", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 4

  struct FFT_Params params = {.fft_size_bits = FFT_SIZE_BITS};

  uint32_t input[1 << FFT_SIZE_BITS] = {0, 1, 2,  3,  4,  5,  6,  7,
                                        8, 9, 10, 11, 12, 13, 14, 15};
  uint32_t correct[1 << FFT_SIZE_BITS] = {0, 8, 4, 12, 2, 10, 6, 14,
                                          1, 9, 5, 13, 3, 11, 7, 15};

  int64_t start_time = esp_timer_get_time();
  for (size_t i = 0; i < 1 << FFT_SIZE_BITS; i++) {
    input[i] = reverse_bits(&params, input[i]);
  }
  int64_t end_time = esp_timer_get_time();
  printf("%lld\n", end_time - start_time);

  for (size_t i = 0; i < 1 << FFT_SIZE_BITS; i++) {
    TEST_ASSERT_EQUAL_INT(correct[i], input[i]);
  }
#undef FFT_SIZE
}

TEST_CASE("reverse_bits_5", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 5

  struct FFT_Params params = {.fft_size_bits = FFT_SIZE_BITS};

  uint32_t input[1 << FFT_SIZE_BITS] = {
      0,  1,  2,  3,  4,  5,  6,  7,  8,  9,  10, 11, 12, 13, 14, 15,
      16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31};
  uint32_t correct[1 << FFT_SIZE_BITS] = {
      0, 16, 8, 24, 4, 20, 12, 28, 2, 18, 10, 26, 6, 22, 14, 30,
      1, 17, 9, 25, 5, 21, 13, 29, 3, 19, 11, 27, 7, 23, 15, 31};

  int64_t start_time = esp_timer_get_time();
  for (size_t i = 0; i < 1 << FFT_SIZE_BITS; i++) {
    input[i] = reverse_bits(&params, input[i]);
  }
  int64_t end_time = esp_timer_get_time();
  printf("%lld\n", end_time - start_time);

  for (size_t i = 0; i < 1 << FFT_SIZE_BITS; i++) {
    TEST_ASSERT_EQUAL_INT(correct[i], input[i]);
  }
#undef FFT_SIZE
}
void run_delta_test(int fft_size_bits, 
                    const struct fix32_10_Complex* twiddles, 
                    int tolerance) {
  struct FFT_Params params = {.fft_size_bits = fft_size_bits};
  size_t fft_size = 1 << fft_size_bits;

  fix32_10 *test_signal = calloc(fft_size, sizeof(fix32_10));
  test_signal[0] = int32_to_fix32_10(1);

  struct fix32_10_Complex *result_freqs = calloc(fft_size, sizeof(struct fix32_10_Complex));

  int64_t start_time = esp_timer_get_time();
  generate_result_freqs(&params, twiddles, test_signal, result_freqs);
  int64_t end_time = esp_timer_get_time();

  printf("delta_test_%d us: %lld\n", fft_size_bits, end_time - start_time);

  for (size_t i = 0; i < fft_size; i++) {
    TEST_ASSERT_INT_WITHIN(tolerance, int32_to_fix32_10(1), result_freqs[i].real);
    TEST_ASSERT_INT_WITHIN(tolerance, 0, result_freqs[i].imag);
  }

  free(test_signal);
  free(result_freqs);
}

TEST_CASE("delta_test_2", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 2

  static const struct fix32_10_Complex complex_twiddle[1 << (FFT_SIZE_BITS - 1)] = {
      {1024, 0}, {0, -1024}};

  run_delta_test(FFT_SIZE_BITS, complex_twiddle, 51); 
#undef FFT_SIZE
}

TEST_CASE("delta_test_3", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 3

  static const struct fix32_10_Complex complex_twiddle[1 << (FFT_SIZE_BITS - 1)] = {
      {1024, 0}, {724, -724}, {0, -1024}, {-724, -724}};

  run_delta_test(FFT_SIZE_BITS, complex_twiddle, 51); 
#undef FFT_SIZE
}

TEST_CASE("delta_test_5", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 5

  static const struct fix32_10_Complex complex_twiddle[1 << (FFT_SIZE_BITS - 1)] = {
      {1024, 0},    {1004, -200},  {946, -392},  {851, -569},
      {724, -724},  {569, -851},   {392, -946},  {200, -1004},
      {0, -1024},   {-200, -1004}, {-392, -946}, {-569, -851},
      {-724, -724}, {-851, -569},  {-946, -392}, {-1004, -200}};

  run_delta_test(FFT_SIZE_BITS, complex_twiddle, 51);
#undef FFT_SIZE
}

TEST_CASE("delta_test_6", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 6

  static const struct fix32_10_Complex complex_twiddle[1 << (FFT_SIZE_BITS - 1)] = {
      {1024, 0},     {1019, -100}, {1004, -200},  {980, -297},   {946, -392},
      {903, -483},   {851, -569},  {792, -650},   {724, -724},   {650, -792},
      {569, -851},   {483, -903},  {392, -946},   {297, -980},   {200, -1004},
      {100, -1019},  {0, -1024},   {-100, -1019}, {-200, -1004}, {-297, -980},
      {-392, -946},  {-483, -903}, {-569, -851},  {-650, -792},  {-724, -724},
      {-792, -650},  {-851, -569}, {-903, -483},  {-946, -392},  {-980, -297},
      {-1004, -200}, {-1019, -100}};

  run_delta_test(FFT_SIZE_BITS, complex_twiddle, 51); 
#undef FFT_SIZE
}

TEST_CASE("delta_test_7", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 7

  static const struct fix32_10_Complex complex_twiddle[1 << (FFT_SIZE_BITS - 1)] = {
      {1024, 0},     {1023, -50},   {1019, -100},  {1013, -150}, {1004, -200},
      {993, -249},   {980, -297},   {964, -345},   {946, -392},  {926, -438},
      {903, -483},   {878, -526},   {851, -569},   {822, -610},  {792, -650},
      {759, -688},   {724, -724},   {688, -759},   {650, -792},  {610, -822},
      {569, -851},   {526, -878},   {483, -903},   {438, -926},  {392, -946},
      {345, -964},   {297, -980},   {249, -993},   {200, -1004}, {150, -1013},
      {100, -1019},  {50, -1023},   {0, -1024},    {-50, -1023}, {-100, -1019},
      {-150, -1013}, {-200, -1004}, {-249, -993},  {-297, -980}, {-345, -964},
      {-392, -946},  {-438, -926},  {-483, -903},  {-526, -878}, {-569, -851},
      {-610, -822},  {-650, -792},  {-688, -759},  {-724, -724}, {-759, -688},
      {-792, -650},  {-822, -610},  {-851, -569},  {-878, -526}, {-903, -483},
      {-926, -438},  {-946, -392},  {-964, -345},  {-980, -297}, {-993, -249},
      {-1004, -200}, {-1013, -150}, {-1019, -100}, {-1023, -50}};

  run_delta_test(FFT_SIZE_BITS, complex_twiddle, 51); 
#undef FFT_SIZE
}

TEST_CASE("delta_test_8", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 8

  static const struct fix32_10_Complex complex_twiddle[1 << (FFT_SIZE_BITS - 1)] = {
      {1024, 0},     {1024, -25},   {1023, -50},   {1021, -75},   {1019, -100},
      {1016, -125},  {1013, -150},  {1009, -175},  {1004, -200},  {999, -224},
      {993, -249},   {987, -273},   {980, -297},   {972, -321},   {964, -345},
      {955, -369},   {946, -392},   {936, -415},   {926, -438},   {915, -460},
      {903, -483},   {891, -505},   {878, -526},   {865, -548},   {851, -569},
      {837, -590},   {822, -610},   {807, -630},   {792, -650},   {775, -669},
      {759, -688},   {742, -706},   {724, -724},   {706, -742},   {688, -759},
      {669, -775},   {650, -792},   {630, -807},   {610, -822},   {590, -837},
      {569, -851},   {548, -865},   {526, -878},   {505, -891},   {483, -903},
      {460, -915},   {438, -926},   {415, -936},   {392, -946},   {369, -955},
      {345, -964},   {321, -972},   {297, -980},   {273, -987},   {249, -993},
      {224, -999},   {200, -1004},  {175, -1009},  {150, -1013},  {125, -1016},
      {100, -1019},  {75, -1021},   {50, -1023},   {25, -1024},   {0, -1024},
      {-25, -1024},  {-50, -1023},  {-75, -1021},  {-100, -1019}, {-125, -1016},
      {-150, -1013}, {-175, -1009}, {-200, -1004}, {-224, -999},  {-249, -993},
      {-273, -987},  {-297, -980},  {-321, -972},  {-345, -964},  {-369, -955},
      {-392, -946},  {-415, -936},  {-438, -926},  {-460, -915},  {-483, -903},
      {-505, -891},  {-526, -878},  {-548, -865},  {-569, -851},  {-590, -837},
      {-610, -822},  {-630, -807},  {-650, -792},  {-669, -775},  {-688, -759},
      {-706, -742},  {-724, -724},  {-742, -706},  {-759, -688},  {-775, -669},
      {-792, -650},  {-807, -630},  {-822, -610},  {-837, -590},  {-851, -569},
      {-865, -548},  {-878, -526},  {-891, -505},  {-903, -483},  {-915, -460},
      {-926, -438},  {-936, -415},  {-946, -392},  {-955, -369},  {-964, -345},
      {-972, -321},  {-980, -297},  {-987, -273},  {-993, -249},  {-999, -224},
      {-1004, -200}, {-1009, -175}, {-1013, -150}, {-1016, -125}, {-1019, -100},
      {-1021, -75},  {-1023, -50},  {-1024, -25}};

  run_delta_test(FFT_SIZE_BITS, complex_twiddle, 51); 
#undef FFT_SIZE
}

TEST_CASE("delta_test_9", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 9

  static const struct fix32_10_Complex complex_twiddle[1 << (FFT_SIZE_BITS - 1)] = {
      {1024, 0},     {1024, -13},   {1024, -25},   {1023, -38},   {1023, -50},
      {1022, -63},   {1021, -75},   {1020, -88},   {1019, -100},  {1018, -113},
      {1016, -125},  {1015, -138},  {1013, -150},  {1011, -163},  {1009, -175},
      {1007, -187},  {1004, -200},  {1002, -212},  {999, -224},   {996, -237},
      {993, -249},   {990, -261},   {987, -273},   {983, -285},   {980, -297},
      {976, -309},   {972, -321},   {968, -333},   {964, -345},   {960, -357},
      {955, -369},   {951, -380},   {946, -392},   {941, -403},   {936, -415},
      {931, -426},   {926, -438},   {920, -449},   {915, -460},   {909, -472},
      {903, -483},   {897, -494},   {891, -505},   {885, -516},   {878, -526},
      {872, -537},   {865, -548},   {858, -558},   {851, -569},   {844, -579},
      {837, -590},   {830, -600},   {822, -610},   {815, -620},   {807, -630},
      {799, -640},   {792, -650},   {784, -659},   {775, -669},   {767, -678},
      {759, -688},   {750, -697},   {742, -706},   {733, -715},   {724, -724},
      {715, -733},   {706, -742},   {697, -750},   {688, -759},   {678, -767},
      {669, -775},   {659, -784},   {650, -792},   {640, -799},   {630, -807},
      {620, -815},   {610, -822},   {600, -830},   {590, -837},   {579, -844},
      {569, -851},   {558, -858},   {548, -865},   {537, -872},   {526, -878},
      {516, -885},   {505, -891},   {494, -897},   {483, -903},   {472, -909},
      {460, -915},   {449, -920},   {438, -926},   {426, -931},   {415, -936},
      {403, -941},   {392, -946},   {380, -951},   {369, -955},   {357, -960},
      {345, -964},   {333, -968},   {321, -972},   {309, -976},   {297, -980},
      {285, -983},   {273, -987},   {261, -990},   {249, -993},   {237, -996},
      {224, -999},   {212, -1002},  {200, -1004},  {187, -1007},  {175, -1009},
      {163, -1011},  {150, -1013},  {138, -1015},  {125, -1016},  {113, -1018},
      {100, -1019},  {88, -1020},   {75, -1021},   {63, -1022},   {50, -1023},
      {38, -1023},   {25, -1024},   {13, -1024},   {0, -1024},    {-13, -1024},
      {-25, -1024},  {-38, -1023},  {-50, -1023},  {-63, -1022},  {-75, -1021},
      {-88, -1020},  {-100, -1019}, {-113, -1018}, {-125, -1016}, {-138, -1015},
      {-150, -1013}, {-163, -1011}, {-175, -1009}, {-187, -1007}, {-200, -1004},
      {-212, -1002}, {-224, -999},  {-237, -996},  {-249, -993},  {-261, -990},
      {-273, -987},  {-285, -983},  {-297, -980},  {-309, -976},  {-321, -972},
      {-333, -968},  {-345, -964},  {-357, -960},  {-369, -955},  {-380, -951},
      {-392, -946},  {-403, -941},  {-415, -936},  {-426, -931},  {-438, -926},
      {-449, -920},  {-460, -915},  {-472, -909},  {-483, -903},  {-494, -897},
      {-505, -891},  {-516, -885},  {-526, -878},  {-537, -872},  {-548, -865},
      {-558, -858},  {-569, -851},  {-579, -844},  {-590, -837},  {-600, -830},
      {-610, -822},  {-620, -815},  {-630, -807},  {-640, -799},  {-650, -792},
      {-659, -784},  {-669, -775},  {-678, -767},  {-688, -759},  {-697, -750},
      {-706, -742},  {-715, -733},  {-724, -724},  {-733, -715},  {-742, -706},
      {-750, -697},  {-759, -688},  {-767, -678},  {-775, -669},  {-784, -659},
      {-792, -650},  {-799, -640},  {-807, -630},  {-815, -620},  {-822, -610},
      {-830, -600},  {-837, -590},  {-844, -579},  {-851, -569},  {-858, -558},
      {-865, -548},  {-872, -537},  {-878, -526},  {-885, -516},  {-891, -505},
      {-897, -494},  {-903, -483},  {-909, -472},  {-915, -460},  {-920, -449},
      {-926, -438},  {-931, -426},  {-936, -415},  {-941, -403},  {-946, -392},
      {-951, -380},  {-955, -369},  {-960, -357},  {-964, -345},  {-968, -333},
      {-972, -321},  {-976, -309},  {-980, -297},  {-983, -285},  {-987, -273},
      {-990, -261},  {-993, -249},  {-996, -237},  {-999, -224},  {-1002, -212},
      {-1004, -200}, {-1007, -187}, {-1009, -175}, {-1011, -163}, {-1013, -150},
      {-1015, -138}, {-1016, -125}, {-1018, -113}, {-1019, -100}, {-1020, -88},
      {-1021, -75},  {-1022, -63},  {-1023, -50},  {-1023, -38},  {-1024, -25},
      {-1024, -13}};

  run_delta_test(FFT_SIZE_BITS, complex_twiddle, 51); 
#undef FFT_SIZE
}

TEST_CASE("delta_test_10", "[fft]") {
#undef FFT_SIZE_BITS
#define FFT_SIZE_BITS 10

  static const struct fix32_10_Complex complex_twiddle[1 << (FFT_SIZE_BITS - 1)] = {
      {1024, 0},     {1024, -6},    {1024, -13},   {1024, -19},   {1024, -25},
      {1024, -31},   {1023, -38},   {1023, -44},   {1023, -50},   {1022, -57},
      {1022, -63},   {1022, -69},   {1021, -75},   {1021, -82},   {1020, -88},
      {1020, -94},   {1019, -100},  {1018, -107},  {1018, -113},  {1017, -119},
      {1016, -125},  {1016, -132},  {1015, -138},  {1014, -144},  {1013, -150},
      {1012, -156},  {1011, -163},  {1010, -169},  {1009, -175},  {1008, -181},
      {1007, -187},  {1006, -194},  {1004, -200},  {1003, -206},  {1002, -212},
      {1000, -218},  {999, -224},   {998, -230},   {996, -237},   {995, -243},
      {993, -249},   {992, -255},   {990, -261},   {989, -267},   {987, -273},
      {985, -279},   {983, -285},   {982, -291},   {980, -297},   {978, -303},
      {976, -309},   {974, -315},   {972, -321},   {970, -327},   {968, -333},
      {966, -339},   {964, -345},   {962, -351},   {960, -357},   {958, -363},
      {955, -369},   {953, -374},   {951, -380},   {948, -386},   {946, -392},
      {944, -398},   {941, -403},   {939, -409},   {936, -415},   {934, -421},
      {931, -426},   {928, -432},   {926, -438},   {923, -443},   {920, -449},
      {917, -455},   {915, -460},   {912, -466},   {909, -472},   {906, -477},
      {903, -483},   {900, -488},   {897, -494},   {894, -499},   {891, -505},
      {888, -510},   {885, -516},   {882, -521},   {878, -526},   {875, -532},
      {872, -537},   {868, -543},   {865, -548},   {862, -553},   {858, -558},
      {855, -564},   {851, -569},   {848, -574},   {844, -579},   {841, -584},
      {837, -590},   {834, -595},   {830, -600},   {826, -605},   {822, -610},
      {819, -615},   {815, -620},   {811, -625},   {807, -630},   {803, -635},
      {799, -640},   {796, -645},   {792, -650},   {788, -654},   {784, -659},
      {779, -664},   {775, -669},   {771, -674},   {767, -678},   {763, -683},
      {759, -688},   {755, -692},   {750, -697},   {746, -702},   {742, -706},
      {737, -711},   {733, -715},   {729, -720},   {724, -724},   {720, -729},
      {715, -733},   {711, -737},   {706, -742},   {702, -746},   {697, -750},
      {692, -755},   {688, -759},   {683, -763},   {678, -767},   {674, -771},
      {669, -775},   {664, -779},   {659, -784},   {654, -788},   {650, -792},
      {645, -796},   {640, -799},   {635, -803},   {630, -807},   {625, -811},
      {620, -815},   {615, -819},   {610, -822},   {605, -826},   {600, -830},
      {595, -834},   {590, -837},   {584, -841},   {579, -844},   {574, -848},
      {569, -851},   {564, -855},   {558, -858},   {553, -862},   {548, -865},
      {543, -868},   {537, -872},   {532, -875},   {526, -878},   {521, -882},
      {516, -885},   {510, -888},   {505, -891},   {499, -894},   {494, -897},
      {488, -900},   {483, -903},   {477, -906},   {472, -909},   {466, -912},
      {460, -915},   {455, -917},   {449, -920},   {443, -923},   {438, -926},
      {432, -928},   {426, -931},   {421, -934},   {415, -936},   {409, -939},
      {403, -941},   {398, -944},   {392, -946},   {386, -948},   {380, -951},
      {374, -953},   {369, -955},   {363, -958},   {357, -960},   {351, -962},
      {345, -964},   {339, -966},   {333, -968},   {327, -970},   {321, -972},
      {315, -974},   {309, -976},   {303, -978},   {297, -980},   {291, -982},
      {285, -983},   {279, -985},   {273, -987},   {267, -989},   {261, -990},
      {255, -992},   {249, -993},   {243, -995},   {237, -996},   {230, -998},
      {224, -999},   {218, -1000},  {212, -1002},  {206, -1003},  {200, -1004},
      {194, -1006},  {187, -1007},  {181, -1008},  {175, -1009},  {169, -1010},
      {163, -1011},  {156, -1012},  {150, -1013},  {144, -1014},  {138, -1015},
      {132, -1016},  {125, -1016},  {119, -1017},  {113, -1018},  {107, -1018},
      {100, -1019},  {94, -1020},   {88, -1020},   {82, -1021},   {75, -1021},
      {69, -1022},   {63, -1022},   {57, -1022},   {50, -1023},   {44, -1023},
      {38, -1023},   {31, -1024},   {25, -1024},   {19, -1024},   {13, -1024},
      {6, -1024},    {0, -1024},    {-6, -1024},   {-13, -1024},  {-19, -1024},
      {-25, -1024},  {-31, -1024},  {-38, -1023},  {-44, -1023},  {-50, -1023},
      {-57, -1022},  {-63, -1022},  {-69, -1022},  {-75, -1021},  {-82, -1021},
      {-88, -1020},  {-94, -1020},  {-100, -1019}, {-107, -1018}, {-113, -1018},
      {-119, -1017}, {-125, -1016}, {-132, -1016}, {-138, -1015}, {-144, -1014},
      {-150, -1013}, {-156, -1012}, {-163, -1011}, {-169, -1010}, {-175, -1009},
      {-181, -1008}, {-187, -1007}, {-194, -1006}, {-200, -1004}, {-206, -1003},
      {-212, -1002}, {-218, -1000}, {-224, -999},  {-230, -998},  {-237, -996},
      {-243, -995},  {-249, -993},  {-255, -992},  {-261, -990},  {-267, -989},
      {-273, -987},  {-279, -985},  {-285, -983},  {-291, -982},  {-297, -980},
      {-303, -978},  {-309, -976},  {-315, -974},  {-321, -972},  {-327, -970},
      {-333, -968},  {-339, -966},  {-345, -964},  {-351, -962},  {-357, -960},
      {-363, -958},  {-369, -955},  {-374, -953},  {-380, -951},  {-386, -948},
      {-392, -946},  {-398, -944},  {-403, -941},  {-409, -939},  {-415, -936},
      {-421, -934},  {-426, -931},  {-432, -928},  {-438, -926},  {-443, -923},
      {-449, -920},  {-455, -917},  {-460, -915},  {-466, -912},  {-472, -909},
      {-477, -906},  {-483, -903},  {-488, -900},  {-494, -897},  {-499, -894},
      {-505, -891},  {-510, -888},  {-516, -885},  {-521, -882},  {-526, -878},
      {-532, -875},  {-537, -872},  {-543, -868},  {-548, -865},  {-553, -862},
      {-558, -858},  {-564, -855},  {-569, -851},  {-574, -848},  {-579, -844},
      {-584, -841},  {-590, -837},  {-595, -834},  {-600, -830},  {-605, -826},
      {-610, -822},  {-615, -819},  {-620, -815},  {-625, -811},  {-630, -807},
      {-635, -803},  {-640, -799},  {-645, -796},  {-650, -792},  {-654, -788},
      {-659, -784},  {-664, -779},  {-669, -775},  {-674, -771},  {-678, -767},
      {-683, -763},  {-688, -759},  {-692, -755},  {-697, -750},  {-702, -746},
      {-706, -742},  {-711, -737},  {-715, -733},  {-720, -729},  {-724, -724},
      {-729, -720},  {-733, -715},  {-737, -711},  {-742, -706},  {-746, -702},
      {-750, -697},  {-755, -692},  {-759, -688},  {-763, -683},  {-767, -678},
      {-771, -674},  {-775, -669},  {-779, -664},  {-784, -659},  {-788, -654},
      {-792, -650},  {-796, -645},  {-799, -640},  {-803, -635},  {-807, -630},
      {-811, -625},  {-815, -620},  {-819, -615},  {-822, -610},  {-826, -605},
      {-830, -600},  {-834, -595},  {-837, -590},  {-841, -584},  {-844, -579},
      {-848, -574},  {-851, -569},  {-855, -564},  {-858, -558},  {-862, -553},
      {-865, -548},  {-868, -543},  {-872, -537},  {-875, -532},  {-878, -526},
      {-882, -521},  {-885, -516},  {-888, -510},  {-891, -505},  {-894, -499},
      {-897, -494},  {-900, -488},  {-903, -483},  {-906, -477},  {-909, -472},
      {-912, -466},  {-915, -460},  {-917, -455},  {-920, -449},  {-923, -443},
      {-926, -438},  {-928, -432},  {-931, -426},  {-934, -421},  {-936, -415},
      {-939, -409},  {-941, -403},  {-944, -398},  {-946, -392},  {-948, -386},
      {-951, -380},  {-953, -374},  {-955, -369},  {-958, -363},  {-960, -357},
      {-962, -351},  {-964, -345},  {-966, -339},  {-968, -333},  {-970, -327},
      {-972, -321},  {-974, -315},  {-976, -309},  {-978, -303},  {-980, -297},
      {-982, -291},  {-983, -285},  {-985, -279},  {-987, -273},  {-989, -267},
      {-990, -261},  {-992, -255},  {-993, -249},  {-995, -243},  {-996, -237},
      {-998, -230},  {-999, -224},  {-1000, -218}, {-1002, -212}, {-1003, -206},
      {-1004, -200}, {-1006, -194}, {-1007, -187}, {-1008, -181}, {-1009, -175},
      {-1010, -169}, {-1011, -163}, {-1012, -156}, {-1013, -150}, {-1014, -144},
      {-1015, -138}, {-1016, -132}, {-1016, -125}, {-1017, -119}, {-1018, -113},
      {-1018, -107}, {-1019, -100}, {-1020, -94},  {-1020, -88},  {-1021, -82},
      {-1021, -75},  {-1022, -69},  {-1022, -63},  {-1022, -57},  {-1023, -50},
      {-1023, -44},  {-1023, -38},  {-1024, -31},  {-1024, -25},  {-1024, -19},
      {-1024, -13},  {-1024, -6}};

  run_delta_test(FFT_SIZE_BITS, complex_twiddle, 51); 
#undef FFT_SIZE
}
